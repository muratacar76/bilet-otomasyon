@{
    ViewData["Title"] = "KullanÄ±cÄ± YÃ¶netimi";
}

<div class="container">
    <div style="margin-bottom: 32px;">
        <div style="display: flex; align-items: center; gap: 16px; margin-bottom: 16px;">
            <a asp-controller="Admin" asp-action="Index" 
               style="padding: 8px 16px; background: #667eea; color: white; text-decoration: none; border-radius: 8px; font-size: 14px;">
                â† Admin Panel
            </a>
            <h1 style="font-size: 32px; font-weight: 800; margin: 0; color: #37474f;">
                ğŸ‘¥ KullanÄ±cÄ± YÃ¶netimi
            </h1>
        </div>
        
        <!-- Ä°statistikler -->
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px; margin-bottom: 32px;">
            <div style="padding: 20px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border-radius: 16px; text-align: center;">
                <div style="font-size: 32px; font-weight: bold;" id="total-users">0</div>
                <div style="font-size: 14px; opacity: 0.9;">Toplam KullanÄ±cÄ±</div>
            </div>
            <div style="padding: 20px; background: linear-gradient(135deg, #4caf50 0%, #388e3c 100%); color: white; border-radius: 16px; text-align: center;">
                <div style="font-size: 32px; font-weight: bold;" id="active-users">0</div>
                <div style="font-size: 14px; opacity: 0.9;">Aktif KullanÄ±cÄ±</div>
            </div>
            <div style="padding: 20px; background: linear-gradient(135deg, #ff9800 0%, #f57c00 100%); color: white; border-radius: 16px; text-align: center;">
                <div style="font-size: 32px; font-weight: bold;" id="passive-users">0</div>
                <div style="font-size: 14px; opacity: 0.9;">Pasif KullanÄ±cÄ±</div>
            </div>
            <div style="padding: 20px; background: linear-gradient(135deg, #9c27b0 0%, #7b1fa2 100%); color: white; border-radius: 16px; text-align: center;">
                <div style="font-size: 32px; font-weight: bold;" id="guest-users">0</div>
                <div style="font-size: 14px; opacity: 0.9;">Misafir KullanÄ±cÄ±</div>
            </div>
            <div style="padding: 20px; background: linear-gradient(135deg, #f44336 0%, #d32f2f 100%); color: white; border-radius: 16px; text-align: center;">
                <div style="font-size: 32px; font-weight: bold;" id="admin-users">0</div>
                <div style="font-size: 14px; opacity: 0.9;">Admin KullanÄ±cÄ±</div>
            </div>
            <div style="padding: 20px; background: linear-gradient(135deg, #00bcd4 0%, #00acc1 100%); color: white; border-radius: 16px; text-align: center;">
                <div style="font-size: 32px; font-weight: bold;" id="new-users">0</div>
                <div style="font-size: 14px; opacity: 0.9;">Bu Ay Yeni</div>
            </div>
        </div>

        <button class="btn btn-primary" onclick="showCreateModal()" style="margin-bottom: 24px;">
            â• Yeni KullanÄ±cÄ± Ekle
        </button>
    </div>

    <!-- KullanÄ±cÄ± Listesi -->
    <div class="card">
        <h2 style="margin-bottom: 24px;">KullanÄ±cÄ± Listesi</h2>
        <div style="overflow-x: auto;">
            <table style="width: 100%; border-collapse: collapse;">
                <thead>
                    <tr style="background: #f8f9ff; border-bottom: 2px solid #e0e0e0;">
                        <th style="padding: 12px; text-align: left; font-weight: bold;">Ad Soyad</th>
                        <th style="padding: 12px; text-align: left; font-weight: bold;">E-posta</th>
                        <th style="padding: 12px; text-align: left; font-weight: bold;">Telefon</th>
                        <th style="padding: 12px; text-align: center; font-weight: bold;">Tip</th>
                        <th style="padding: 12px; text-align: center; font-weight: bold;">Durum</th>
                        <th style="padding: 12px; text-align: center; font-weight: bold;">Rezervasyon</th>
                        <th style="padding: 12px; text-align: center; font-weight: bold;">KayÄ±t Tarihi</th>
                        <th style="padding: 12px; text-align: center; font-weight: bold;">Ä°ÅŸlemler</th>
                    </tr>
                </thead>
                <tbody id="users-tbody">
                    <!-- KullanÄ±cÄ±lar JavaScript ile yÃ¼klenecek -->
                </tbody>
            </table>
        </div>
    </div>
</div>

<!-- KullanÄ±cÄ± OluÅŸturma Modal -->
<div id="create-modal" class="modal" style="display: none;">
    <div class="modal-content">
        <span class="close" onclick="hideCreateModal()">&times;</span>
        <h2 style="margin-bottom: 24px; text-align: center;">â• Yeni KullanÄ±cÄ± Ekle</h2>
        <form id="create-form">
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px;">
                <div class="form-group">
                    <label>Ad</label>
                    <input type="text" id="create-firstName" required />
                </div>
                <div class="form-group">
                    <label>Soyad</label>
                    <input type="text" id="create-lastName" required />
                </div>
            </div>
            
            <div class="form-group">
                <label>E-posta</label>
                <input type="email" id="create-email" required />
            </div>
            
            <div class="form-group">
                <label>Åifre</label>
                <input type="password" id="create-password" placeholder="BoÅŸ bÄ±rakÄ±lÄ±rsa ÅŸifresiz oluÅŸturulur" />
            </div>
            
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px;">
                <div class="form-group">
                    <label>Telefon</label>
                    <input type="tel" id="create-phoneNumber" placeholder="05xxxxxxxxx" maxlength="11" />
                </div>
                <div class="form-group">
                    <label>TC Kimlik No</label>
                    <input type="text" id="create-identityNumber" maxlength="11" />
                </div>
            </div>
            
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px;">
                <div class="form-group">
                    <label>DoÄŸum Tarihi</label>
                    <input type="date" id="create-dateOfBirth" />
                </div>
                <div class="form-group">
                    <label>Cinsiyet</label>
                    <select id="create-gender">
                        <option value="Erkek">Erkek</option>
                        <option value="KadÄ±n">KadÄ±n</option>
                    </select>
                </div>
            </div>
            
            <div style="display: flex; gap: 12px; margin-top: 24px;">
                <button type="submit" class="btn btn-primary" style="flex: 1;">
                    âœ… KullanÄ±cÄ± OluÅŸtur
                </button>
                <button type="button" class="btn btn-secondary" onclick="hideCreateModal()">
                    Ä°ptal
                </button>
            </div>
        </form>
    </div>
</div>

<!-- KullanÄ±cÄ± DÃ¼zenleme Modal -->
<div id="edit-modal" class="modal" style="display: none;">
    <div class="modal-content">
        <span class="close" onclick="hideEditModal()">&times;</span>
        <h2 style="margin-bottom: 20px; text-align: center; font-size: 20px;">âœï¸ KullanÄ±cÄ± DÃ¼zenle</h2>
        <form id="edit-form">
            <input type="hidden" id="edit-userId" />
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px;">
                <div class="form-group">
                    <label>Ad</label>
                    <input type="text" id="edit-firstName" required />
                </div>
                <div class="form-group">
                    <label>Soyad</label>
                    <input type="text" id="edit-lastName" required />
                </div>
            </div>
            
            <div class="form-group">
                <label>E-posta</label>
                <input type="email" id="edit-email" required />
            </div>
            
            <div class="form-group">
                <label>Yeni Åifre</label>
                <input type="password" id="edit-password" placeholder="DeÄŸiÅŸtirmek istemiyorsanÄ±z boÅŸ bÄ±rakÄ±n" />
            </div>
            
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px;">
                <div class="form-group">
                    <label>Telefon</label>
                    <input type="tel" id="edit-phoneNumber" placeholder="05xxxxxxxxx" maxlength="11" />
                </div>
                <div class="form-group">
                    <label>TC Kimlik No</label>
                    <input type="text" id="edit-identityNumber" maxlength="11" />
                </div>
            </div>
            
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px;">
                <div class="form-group">
                    <label>DoÄŸum Tarihi</label>
                    <input type="date" id="edit-dateOfBirth" />
                </div>
                <div class="form-group">
                    <label>Cinsiyet</label>
                    <select id="edit-gender">
                        <option value="Erkek">Erkek</option>
                        <option value="KadÄ±n">KadÄ±n</option>
                    </select>
                </div>
            </div>
            
            <div style="display: flex; gap: 12px; margin-top: 24px;">
                <button type="submit" class="btn btn-primary" style="flex: 1;">
                    âœ… GÃ¼ncelle
                </button>
                <button type="button" class="btn btn-secondary" onclick="hideEditModal()">
                    Ä°ptal
                </button>
            </div>
        </form>
    </div>
</div>

@section Scripts {
    <script src="~/js/admin.js"></script>
    <script>
        // Form submit olaylarÄ±

        document.getElementById('create-form').addEventListener('submit', async function(e) {
            e.preventDefault();

            const formData = {
                firstName: document.getElementById('create-firstName').value,
                lastName: document.getElementById('create-lastName').value,
                email: document.getElementById('create-email').value,
                password: document.getElementById('create-password').value,
                phoneNumber: document.getElementById('create-phoneNumber').value,
                identityNumber: document.getElementById('create-identityNumber').value,
                dateOfBirth: document.getElementById('create-dateOfBirth').value,
                gender: document.getElementById('create-gender').value
            };

            await userManager.createUser(formData);
            hideCreateModal();
        });

        document.getElementById('edit-form').addEventListener('submit', async function(e) {
            e.preventDefault();

            const userId = document.getElementById('edit-userId').value;
            const formData = {
                firstName: document.getElementById('edit-firstName').value,
                lastName: document.getElementById('edit-lastName').value,
                email: document.getElementById('edit-email').value,
                password: document.getElementById('edit-password').value,
                phoneNumber: document.getElementById('edit-phoneNumber').value,
                identityNumber: document.getElementById('edit-identityNumber').value,
                dateOfBirth: document.getElementById('edit-dateOfBirth').value,
                gender: document.getElementById('edit-gender').value
            };

            await userManager.updateUser(userId, formData);
            hideEditModal();
        });
    </script>
}